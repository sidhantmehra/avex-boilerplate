{%- assign current_variant = product.selected_or_first_available_variant -%}
{%- assign swatchesEnabled = true -%}

<div class="main product row">
  <div class="product-images-container col-6">
    <div class="product__gallery product-gallery">
    {%- for image in product.images -%}
      <div class="product-gallery__item">
        <img 
          class="lazyload"
          src="{{ image.src | img_url: '12x12' }}"
          data-src="{{ image.src | img_url: 'x1024'}}"
          data-sizes="auto" 
          alt="{{product.title}}"
        >
      </div>
    {%- endfor -%}
      
      
  </div>
  <div class="product__thumbnail product-thumbnail">
  {%- for image in product.images -%}
      <div class="product-thumbnail__item">
        <img 
          class="lazyload"
          src="{{ image.src | img_url: '12x12' }}"
          data-src="{{ image.src | img_url: 'x50'}}"
          data-sizes="auto" 
          alt="{{product.title}}"
        >
      </div>
    {%- endfor -%}
    </div>
  </div>
    <div class="product__details col-6">
    <h1 class="product__title">{{ product.title }}</h1>
    <p class="product__vendor">{{ product.vendor }}</p>
    <p class="product__description">{{ product.description }}</p>
      <h5 class="product__price">
        <span class="current-price">{{ current_variant.price | money}}</span>
        {%if current_variant.compare_at_price%}
        <span class="compare-at-price">{{current_variant.compare_at_price | money}}
        {%endif%}
        </span>
      </h5>  
    {% form "product", product, id:'productForm', class:'product__form product-form' %}
      
    {% for product_option in product.options_with_values %}
      {%- assign optionIndex = 'option' | append: forloop.index -%}
      
      {% if product_option.name == 'Color' and swatchesEnabled %}
      
        {%- comment -%}
        
        Swatches:
        ---
        Swatches can be disabled/enabled through the parameter above. New swatches should be added to the files section of the Admin panel. Following a handleized version of the option value
        
        {%- endcomment -%}
        <fieldset 
          class="option-select option-select--swatches" name="{{optionIndex}}">
          {% for value in product_option.values %}
            <div class="product-form__field">
              <input 
                class="product-option-select"
                type="radio" 
                name="{{optionIndex}}" 
                value="{{value}}"
                id="{{optionIndex}}-{{value}}"
                {% if current_variant[optionIndex] == value %}
                checked="checked"
                {% endif %}
              >
              <label for="option{{index}}-{{value}}" >
                <img src="{{ value | handleize | append: '.jpg' | file_url }}" alt="{{value}}">
              </label>
            </div>
          {% endfor %}
        </fieldset>
      {%- else -%}
        {%- comment -%}
        
        Ordinary option select
        
        {%- endcomment -%}
        <fieldset 
          class="option-select option-select--swatches" name="{{optionIndex}}">
          {% for value in product_option.values %}
            <div class="product-form__field">
              <input 
                class="product-option-select"
                type="radio" 
                name="{{optionIndex}}" 
                value="{{value}}"
                id="{{optionIndex}}-{{value}}"
                {% if current_variant[optionIndex] == value %}
                checked="checked"
                {% endif %}
              >
              <label for="option{{index}}-{{value}}" >
                {{value}}
              </label>
            </div>
          {% endfor %}
        </fieldset>
      {% endif %}
    {% endfor %}
      
    
      {%- comment -%}
        DO NOT REMOVE
      {%- endcomment -%}
      <div class="hidden">
        <select name="id" id="variant-select">
          {% for variant in product.variants %}
            <option 
              {% if variant == current_variant %} selected="selected" {% endif %}
              value="{{ variant.id }}"
            >
                {{ variant.title  }} - {{ variant.price | money }}
            </option>
          {% endfor %}
        </select>
      </div>
      
      {%if product.metafields.accentuate.custom_swatches%}
      	{%-assign swatchProducts = product.metafields.accentuate.custom_swatches | split: '|' -%}
      	{%for swatchProduct in swatchProducts %}
          <a class="custom-swatch" href="javascript:void(0)"
             data-handle="{{all_products[swatchProduct].handle}}"
             data-href="{{all_products[swatchProduct].url | prepend: shop.url | append: '.js'}}">
              <img 
                class="lazyload"
                src="{{ all_products[swatchProduct].featured_image.src | img_url: '12x12' }}"
                data-src="{{ all_products[swatchProduct].featured_image.src | img_url: 'x100'}}"
                data-sizes="auto" 
                alt="{{all_products[swatchProduct].featured_image.title}}"
              >
          </a>
      	{%endfor%}
      {%endif%}
      <div class="product-form__quantity">
        <input type="text" value="1" name="quantity"/>
      </div>
      <div class="product-form__atc">
        <button type="submit">Add to cart</button>
      </div>
    {% endform %}
  </div>
</div>

